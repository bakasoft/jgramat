@object Query =
  {
    @set(
        {+ <`= & #`|$> }:
        [ "=" @string({ <`& #`|$> })]
    )
    / {+ "&" }
   }
  { "&" }

@object Url =
  [ @set('scheme': @string({+ <":">})) ":" ]
  [ "//" [ @set('userinfo': @string({ <"@"> })) "@" ]
    @set('host': @string({+ <`: /`|$> }))
    [ ":" @set('port': @integer({+ <"/"|$> })) ] ]
  [ @set('path': @string("/" {+ <`? #`|$> })) ]
  [ "?" @set('query': Query) ]
  [ "#" @set('fragment': @string({<$>})) ]