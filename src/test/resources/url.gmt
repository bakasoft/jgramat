@object Query =
  {
    @set(
        {+ <`= & #`|$> }:
        [ "=" @string({ <`& #`|$> })]
    )
    / {+ "&" }
   }
  { "&" }

@set scheme = @string({+ <":"> })
@set user_info = @string({+ <"@"> })
@set host = @string({+ <`: /` | $> })
@set port = @integer({+ `0-9` })
@set path = @string("/" {+ <`? #` | $> })
@set query = Query
@set fragment = @string({<$>})

@object Url =
  ^ [ scheme ":" ] [ "//" [ user_info "@" ] host [ ":" port ] ]
  path [ "?" query ] [ "#" fragment ] $
