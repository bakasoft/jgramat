@object InstructionBody = "{" ws @set(`instructions`: InstructionList) ws "}"

@list InstructionList = { Instruction / line-break }

Instruction = LocalField | InvocationInst | AssignationInst

@object ValuePart = [ @set(`optional`: @true("?")) i-ws ] "." i-ws @set(`name`: Name)
@list ValuePartList = ValuePart { i-ws ValuePart }
@object MemberRef =
    @set(`name`: Name) [ i-ws @set(`parts`: ValuePartList) ]
    [ [ i-ws @set(`optional`: @true("?")) ] i-ws "[" ws @set(`key`: Expression) ws "]" ]

@object InvocationInst =
    @set(`member`: MemberRef) i-ws @set(`arguments`: InvocationArgumentGroup)

@object AssignationInst =
    @set(`member`: MemberRef) i-ws "=" i-ws @set(`value`: Expression)

@object LocalField =
    @set(`fieldType`: FieldType) ws @set(`name`: Name)
    [ ws @set(`dataType`: TypeRef) ]
    [ ws "=" ws @set(`initialValue`: Expression) ]
